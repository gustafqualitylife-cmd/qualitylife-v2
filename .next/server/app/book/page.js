(()=>{var e={};e.id=886,e.ids=[886],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5721:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>c,pages:()=>u,routeModule:()=>g,tree:()=>d}),r(3863),r(691),r(5866);var a=r(3191),s=r(8716),n=r(7922),l=r.n(n),i=r(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d=["",{children:["book",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3863)),"C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\book\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,691)),"C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\book\\page.tsx"],c="/book/page",m={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/book/page",pathname:"/book",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2485:(e,t,r)=>{Promise.resolve().then(r.bind(r,7641))},7641:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(326),s=r(7577);let n="cmfmtab9i0000nc4owma6zi5i";function l(e){return String(e).padStart(2,"0")}function i(e){return`${e.getFullYear()}-${l(e.getMonth()+1)}-${l(e.getDate())}`}function o(e){let[t,r,a]=e.split("-").map(Number);return new Date(t,(r??1)-1,a??1,0,0,0,0)}function d(e){let t=new Date(e),r=t.getDay();return t.setDate(t.getDate()-(r+6)%7),t.setHours(0,0,0,0),t}function u(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function c(e){return e.replace(/\D/g,"").length>=7}function m(e){return e.trim().length>=5}function g(){let[e,t]=(0,s.useState)(()=>i(new Date)),[r,l]=(0,s.useState)({}),[g,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),[N,D]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),[q,P]=(0,s.useState)(""),[$,_]=(0,s.useState)(""),[T,A]=(0,s.useState)({}),[E,F]=(0,s.useState)(!1),[M,I]=(0,s.useState)(null),[B,O]=(0,s.useState)(null),Y=(0,s.useRef)(null),z=(0,s.useCallback)(async()=>{y(!0),j(null);try{let t=await fetch(`/api/contact/open/week?resourceId=${n}&week=${e}`,{cache:"no-store"}),r=await t.json();if(!t.ok)throw Error("Kunde inte h\xe4mta lediga tider.");l(r.days||{})}catch(e){j(e?.message??"Ett fel uppstod n\xe4r tider skulle h\xe4mtas."),l({})}finally{y(!1)}},[e]);function G(r){let a=o(e);a.setDate(a.getDate()+7*r),t(i(a)),w(null),I(null),O(null)}let U=(0,s.useMemo)(()=>{let t=d(o(e));return Array.from({length:7},(e,a)=>{let s=new Date(t);s.setDate(t.getDate()+a);let n=i(s);return{key:n,label:new Intl.DateTimeFormat("sv-SE",{weekday:"short",day:"numeric"}).format(s),slots:r[n]||[]}})},[e,r]),V=(0,s.useMemo)(()=>Object.values(r).some(e=>(e?.length||0)>0),[r]);async function W(e){e.preventDefault(),O(null),I(null);let t=!!N.trim(),r=u(S),a=c(q),s=m($);if(!k){O("V\xe4lj en tid f\xf6rst.");return}if(!t||!r||!a||!s){A({name:!0,email:!0,phone:!0,address:!0}),O("Kontrollera att alla f\xe4lt \xe4r korrekt ifyllda.");return}F(!0);try{let e=await fetch("/api/contact/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resourceId:n,startIso:new Date(k).toISOString(),name:N,email:S,phone:q,address:$})}),t=await e.json();if(!e.ok||!t?.ok)throw Error(t?.error||"Kunde inte boka tiden.");I("Tack! Din bokningsf\xf6rfr\xe5gan \xe4r mottagen. Vi \xe5terkommer med bekr\xe4ftelse."),l(e=>{let t=new Date(k),r=i(t),a={...e};return a[r]=(a[r]||[]).filter(e=>e.iso!==k),a}),w(null),A({})}catch(e){O(e?.message??"Ett fel uppstod.")}finally{F(!1)}}let K=k?new Date(k).toLocaleString("sv-SE"):"Ingen vald";return(0,a.jsxs)("main",{className:"mx-auto max-w-5xl p-4",children:[(0,a.jsxs)("header",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight",children:"Boka en tid"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"V\xe4lj en ledig tid och fyll i dina uppgifter. Tider visas i din lokala tidszon."})]}),a.jsx("section",{ref:Y,tabIndex:0,onKeyDown:e=>{"ArrowLeft"===e.key?(e.preventDefault(),G(-1)):"ArrowRight"===e.key&&(e.preventDefault(),G(1))},"aria-label":"Veckonavigering",className:"sticky top-0 z-10 bg-white/80 backdrop-blur supports-[backdrop-filter]:bg-white/60 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>G(-1),className:"rounded-full border border-gray-300 px-3 py-1 text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-emerald-600","aria-label":"F\xf6reg\xe5ende vecka",children:"Tidigare"}),a.jsx("button",{onClick:()=>G(1),className:"rounded-full border border-gray-300 px-3 py-1 text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-emerald-600","aria-label":"N\xe4sta vecka",children:"Senare"})]}),a.jsx("div",{className:"text-sm font-medium text-gray-700","aria-live":"polite",children:function(e){let t=o(e),r=d(t),a=function(e){let t=d(e),r=new Date(t);return r.setDate(t.getDate()+6),r.setHours(23,59,59,999),r}(t),s=new Intl.DateTimeFormat("sv-SE",{day:"numeric",month:"short"}),n=r.getMonth()===a.getMonth(),l=s.format(r),i=n?new Intl.DateTimeFormat("sv-SE",{day:"numeric"}).format(a):s.format(a),u=r.getFullYear()===a.getFullYear()?r.getFullYear():`${r.getFullYear()}–${a.getFullYear()}`;return`${l}–${i} ${u}`}(e)})]})}),v&&(0,a.jsxs)(b,{kind:"error",onRetry:z,children:[v," ",a.jsx("span",{className:"sr-only",children:"."})]}),a.jsx("section",{className:"mt-4",children:g?a.jsx(f,{}):(0,a.jsxs)(a.Fragment,{children:[!V&&a.jsx("div",{className:"mb-6 rounded-xl border border-gray-200 p-4 text-sm text-gray-700 bg-white",children:"Det finns inga lediga tider den h\xe4r veckan. Prova att byta vecka med knapparna ovan."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:U.map(({key:e,label:t,slots:r})=>a.jsx(x,{label:t,empty:0===r.length,children:0===r.length?a.jsx("span",{className:"text-xs text-gray-500",children:"Inga lediga tider"}):a.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(e=>{let t=k===e.iso;return a.jsx(p,{label:e.label,iso:e.iso,active:t,onSelect:()=>w(e.iso)},e.iso)})})},e))})]})}),(0,a.jsxs)("section",{"aria-live":"polite",className:"max-w-xl",children:[B&&a.jsx(b,{kind:"warning",children:B}),M&&null===k&&(0,a.jsxs)("div",{className:"mb-4 rounded-xl border border-emerald-200 bg-emerald-50 p-4 text-emerald-900",children:[a.jsx("h2",{className:"font-medium mb-1",children:"Tack!"}),a.jsx("p",{className:"text-sm",children:M}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:()=>{D(""),C(""),P(""),_(""),A({}),I(null),O(null)},className:"rounded-lg border border-gray-300 px-3 py-1.5 text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-emerald-600",children:"Boka en till tid"}),a.jsx("button",{onClick:()=>{t(i(new Date)),w(null)},className:"rounded-lg bg-emerald-600 text-white px-3 py-1.5 text-sm hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-600",children:"G\xe5 till denna vecka"})]})]})]}),(0,a.jsxs)("form",{onSubmit:W,className:"border rounded-2xl p-4 md:p-6 space-y-4 max-w-xl bg-white shadow-sm","aria-busy":E?"true":"false",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Dina uppgifter"}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"selected",className:"block text-sm font-medium",children:"Vald tid"}),a.jsx("input",{id:"selected",className:"mt-1 w-full border rounded-lg px-3 py-2 bg-gray-50",value:K,readOnly:!0}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Tider visas i din lokala tidszon."})]}),a.jsx(h,{id:"name",label:"Namn",value:N,onChange:e=>D(e),onBlur:()=>A(e=>({...e,name:!0})),autoComplete:"name",required:!0,invalid:T.name&&!N.trim(),errorText:"Ange ditt namn."}),a.jsx(h,{id:"email",type:"email",label:"E-post",value:S,onChange:e=>C(e),onBlur:()=>A(e=>({...e,email:!0})),autoComplete:"email",required:!0,invalid:T.email&&!u(S),errorText:"Ange en giltig e-postadress."}),a.jsx(h,{id:"phone",label:"Telefon",inputMode:"tel",autoComplete:"tel",value:q,onChange:e=>P(e),onBlur:()=>A(e=>({...e,phone:!0})),required:!0,invalid:T.phone&&!c(q),errorText:"Ange ett giltigt telefonnummer."}),a.jsx(h,{id:"address",label:"Adress",value:$,onChange:e=>_(e),onBlur:()=>A(e=>({...e,address:!0})),autoComplete:"street-address",required:!0,invalid:T.address&&!m($),errorText:"Ange en fullst\xe4ndig adress."}),a.jsx("div",{className:"pt-2",children:a.jsx("button",{type:"submit",disabled:!k||E,className:"rounded-xl px-4 py-2 bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-emerald-600",children:E?"Skickar…":"Skicka bokningsf\xf6rfr\xe5gan"})})]})]})}function x({label:e,empty:t,children:r}){return(0,a.jsxs)("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"font-medium capitalize",children:e}),t&&a.jsx("span",{className:"text-xs text-gray-400","aria-hidden":!0,children:"–"})]}),r]})}function p({label:e,iso:t,active:r,onSelect:s}){return a.jsx("button",{type:"button",onClick:s,"aria-pressed":r,className:`text-sm rounded-full px-3 py-1 border transition focus:outline-none focus:ring-2 focus:ring-emerald-600 ${r?"bg-emerald-600 text-white border-emerald-600":"bg-white hover:bg-gray-50 border-gray-300"}`,title:new Date(t).toLocaleString("sv-SE"),children:e})}function b({kind:e="info",children:t,onRetry:r}){return(0,a.jsxs)("div",{role:"error"===e?"alert":"status",className:`mb-4 rounded-xl border p-3 ${"error"===e?"border-red-200 bg-red-50 text-red-900":"warning"===e?"border-amber-200 bg-amber-50 text-amber-900":"border-gray-200 bg-gray-50 text-gray-900"}`,children:[a.jsx("div",{className:"text-sm",children:t}),r&&a.jsx("button",{onClick:r,className:"mt-2 rounded-lg border border-gray-300 px-3 py-1.5 text-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-emerald-600",children:"F\xf6rs\xf6k igen"})]})}function h(e){let{id:t,label:r,value:s,onChange:n,onBlur:l,type:i="text",inputMode:o,autoComplete:d,required:u,invalid:c,errorText:m}=e,g=c?`${t}-error`:void 0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:t,className:"block text-sm font-medium",children:[r," ",u&&a.jsx("span",{className:"text-red-600","aria-hidden":!0,children:"*"})]}),a.jsx("input",{id:t,type:i,inputMode:o,autoComplete:d,className:`mt-1 w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-600 ${c?"border-red-500":""}`,value:s,onChange:e=>n(e.target.value),onBlur:l,"aria-invalid":c?"true":"false","aria-describedby":g,required:u}),c&&m&&a.jsx("p",{id:`${t}-error`,className:"mt-1 text-sm text-red-600",children:m})]})}function f(){return a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:Array.from({length:6}).map((e,t)=>(0,a.jsxs)("div",{className:"border rounded-xl p-3 bg-white shadow-sm",children:[a.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded mb-3 animate-pulse"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:4}).map((e,t)=>a.jsx("div",{className:"h-7 w-16 bg-gray-200 rounded-full animate-pulse"},t))})]},t))})}},3863:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var a=r(8570);let s=(0,a.createProxy)(String.raw`C:\Users\gusta\Desktop\Webbutveckling\qualitylife\src\app\book\page.tsx`),{__esModule:n,$$typeof:l}=s;s.default;let i=(0,a.createProxy)(String.raw`C:\Users\gusta\Desktop\Webbutveckling\qualitylife\src\app\book\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,917,83],()=>r(5721));module.exports=a})();