(()=>{var e={};e.id=323,e.ids=[323],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4242:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),a(9332),a(691),a(5866);var r=a(3191),s=a(8716),n=a(7922),i=a.n(n),o=a(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(t,l);let c=["",{children:["admin",{children:["schema",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,9332)),"C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\admin\\schema\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,691)),"C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\gusta\\Desktop\\Webbutveckling\\qualitylife\\src\\app\\admin\\schema\\page.tsx"],u="/admin/schema/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/schema/page",pathname:"/admin/schema",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8430:(e,t,a)=>{Promise.resolve().then(a.bind(a,3123))},3123:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(326),s=a(7577);let n="cmfmtab9i0000nc4owma6zi5i",i=["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00"];function o(e){return String(e).padStart(2,"0")}function l(e){return`${e.getFullYear()}-${o(e.getMonth()+1)}-${o(e.getDate())}`}function c(e){let[t,a,r]=e.split("-").map(Number);return new Date(t,(a??1)-1,r??1,0,0,0,0)}function d(e){let t=new Date(e),a=t.getDay();return t.setDate(t.getDate()-(a+6)%7),t.setHours(0,0,0,0),t}function u(){let[e,t]=(0,s.useState)(()=>l(new Date)),[a,o]=(0,s.useState)({}),[u,p]=(0,s.useState)({}),m=(0,s.useRef)(new Set),g=(0,s.useMemo)(()=>{let t=d(c(e)),a=new Date(t);a.setDate(t.getDate()+6);let r=new Intl.DateTimeFormat("sv-SE",{month:"short",day:"numeric"});return`${r.format(t).toUpperCase()} – ${r.format(a).toUpperCase()}`},[e]);async function x(){let t=await fetch(`/api/contact/open/week?resourceId=${n}&week=${e}`,{cache:"no-store"});o((await t.json()).days||{})}async function f(e){let t=await fetch(`/api/contact/open/week?resourceId=${n}&week=${e}`,{cache:"no-store"}),a=await t.json();return a?.days??{}}function h(a){let r=c(e);r.setDate(r.getDate()+7*a),t(l(r))}let b=(0,s.useMemo)(()=>{let t=d(c(e));return Array.from({length:7},(e,r)=>{let s=new Date(t);s.setDate(t.getDate()+r);let n=l(s),i=new Intl.DateTimeFormat("sv-SE",{weekday:"short",day:"numeric"}).format(s),o=new Set((a[n]||[]).map(e=>e.label));return{key:n,label:i,openSet:o}})},[e,a]);async function w(t,a,r){let s=`${t}|${a}`;if(!m.current.has(s)){m.current.add(s),o(e=>{let s={...e},n=s[t]?[...s[t]]:[],i=n.some(e=>e.label===a);if(r)i||n.push({iso:"",label:a});else if(i){let e=n.filter(e=>e.label!==a);return s[t]=e,s}return s[t]=n,s}),p(e=>({...e,[s]:!0}));try{let s=new Date(`${t}T${a}:00`).toISOString(),i=await fetch("/api/contact/admin/open/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resourceId:n,date:t,time:a,startIso:s,desired:r?"open":"closed"})}),l=await i.json().catch(()=>({}));if(!i.ok||!l?.ok)throw Error(l?.error||`HTTP ${i.status}`);await new Promise(e=>setTimeout(e,120));let c=await f(e),d=new Set((c[t]??[]).map(e=>e.label));r!==d.has(a)&&(await new Promise(e=>setTimeout(e,200)),c=await f(e)),o(c)}catch(e){console.error("Toggle failed",e),await x()}finally{p(e=>{let t={...e};return delete t[s],t}),m.current.delete(s)}}}return(0,r.jsxs)("main",{className:"mx-auto max-w-4xl p-4",children:[r.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Admin – \xf6ppna tider"}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("button",{onClick:()=>h(-1),className:"rounded-full border px-3 py-1",children:"Tidigare"}),r.jsx("div",{className:"text-sm uppercase tracking-wide",children:g}),r.jsx("button",{onClick:()=>h(1),className:"rounded-full border px-3 py-1",children:"Senare"})]}),r.jsx("div",{className:"grid grid-cols-7 gap-2 text-sm",children:b.map(({key:e,label:t,openSet:a})=>(0,r.jsxs)("div",{className:"border rounded-lg p-2",children:[r.jsx("div",{className:"font-medium mb-2",children:t}),r.jsx("div",{className:"flex flex-col gap-2",children:i.map(t=>{let s=a.has(t),n=!0===u[`${e}|${t}`];return(0,r.jsxs)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),n||w(e,t,!s)},disabled:n,className:`rounded-xl px-3 py-2 border ${s?"bg-emerald-50 border-emerald-300":"bg-gray-50 border-gray-300"} ${n?"opacity-60 cursor-not-allowed pointer-events-none":""}`,children:[t," ",s?"• \xf6ppen":"• st\xe4ngd",n?" (sparar…)":""]},t)})})]},e))})]})}},9332:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>o});var r=a(8570);let s=(0,r.createProxy)(String.raw`C:\Users\gusta\Desktop\Webbutveckling\qualitylife\src\app\admin\schema\page.tsx`),{__esModule:n,$$typeof:i}=s;s.default;let o=(0,r.createProxy)(String.raw`C:\Users\gusta\Desktop\Webbutveckling\qualitylife\src\app\admin\schema\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,917,83],()=>a(4242));module.exports=r})();